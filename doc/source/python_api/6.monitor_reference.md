---
title: 状态监控服务
createTime: 2025/01/27 15:30:00
permalink: /dog/python_monitor_reference/
---
# 状态监控服务 (Python)

> 提供机器人系统运行状态监控，包括故障检测、电池状态等。

## 接口定义

<code>StateMonitor</code> 是机器人运行状态监控，包括故障检测、电池状态等。

### <code>StateMonitor</code> — 状态监控器

<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>类名</td><td><code>StateMonitor</code></td></tr>
    <tr><td>功能概述</td><td>机器人运行状态监控，包括故障检测、电池状态等</td></tr>
    <tr><td>主要功能</td><td>状态查询、故障监控、健康检查</td></tr>
    <tr><td>使用场景</td><td>系统监控、故障诊断、状态报告</td></tr>
  </tbody>
</table>

### initialize
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>initialize</code></td></tr>
    <tr><td>方法声明</td><td><code>bool initialize()</code></td></tr>
    <tr><td>功能概述</td><td>初始化状态监控器。</td></tr>
    <tr><td>返回值</td><td><code>true</code> 表示成功，<code>false</code> 表示失败。</td></tr>
    <tr><td>备注</td><td>首次使用前必须调用。</td></tr>
  </tbody>
</table>

### shutdown
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>shutdown</code></td></tr>
    <tr><td>方法声明</td><td><code>void shutdown()</code></td></tr>
    <tr><td>功能概述</td><td>关闭状态监控器。</td></tr>
    <tr><td>备注</td><td>配合 initialize 使用。</td></tr>
  </tbody>
</table>

### get_current_state
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>get_current_state</code></td></tr>
    <tr><td>方法声明</td><td><code>RobotState get_current_state()</code></td></tr>
    <tr><td>功能概述</td><td>获取机器人当前状态信息。</td></tr>
    <tr><td>返回值</td><td>机器人状态信息，包含电池状态、故障信息等。</td></tr>
    <tr><td>备注</td><td>非阻塞接口，用于获取机器人当前状态信息。</td></tr>
  </tbody>
</table>

## 错误码映射表

<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>错误码（十六进制）</strong></th>
      <th style="width: 60%; text-align: center;"><strong>错误描述</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>0x0000</td><td>无错误</td></tr>
    <tr><td>0x1101</td><td>调用 ROS 服务失败</td></tr>
    <tr><td>0x1301</td><td>中控节点丢失</td></tr>
    <tr><td>0x1302</td><td>APP 节点丢失</td></tr>
    <tr><td>0x1304</td><td>音频节点丢失</td></tr>
    <tr><td>0x1305</td><td>运动节点丢失</td></tr>
    <tr><td>0x1306</td><td>LCD 节点丢失</td></tr>
    <tr><td>0x1307</td><td>realsense 节点丢失</td></tr>
    <tr><td>0x1308</td><td>双目相机节点丢失</td></tr>
    <tr><td>0x1309</td><td>LDS 节点丢失</td></tr>
    <tr><td>0x130A</td><td>传感器板节点丢失</td></tr>
    <tr><td>0x130B</td><td>触摸节点丢失</td></tr>
    <tr><td>0x130C</td><td>SLAM 节点丢失</td></tr>
    <tr><td>0x130D</td><td>导航节点丢失</td></tr>
    <tr><td>0x130E</td><td>AI 节点丢失</td></tr>
    <tr><td>0x130F</td><td>头部节点丢失</td></tr>
    <tr><td>0x1310</td><td>云端处理器节点丢失</td></tr>
    <tr><td>0x3201</td><td>激光无数据</td></tr>
    <tr><td>0x3202</td><td>双目相机无数据</td></tr>
    <tr><td>0x3203</td><td>双目相机数据错误</td></tr>
    <tr><td>0x3204</td><td>双目相机初始化失败</td></tr>
    <tr><td>0x320B</td><td>里程计无数据</td></tr>
    <tr><td>0x320C</td><td>IMU 无数据</td></tr>
    <tr><td>0x6101</td><td>机器人连接 APP 失败</td></tr>
    <tr><td>0x6102</td><td>与 APP 断开连接</td></tr>
    <tr><td>0x9201</td><td>打开 LCD 串口失败</td></tr>
    <tr><td>0x7201</td><td>打开头部串口失败</td></tr>
    <tr><td>0x7202</td><td>头部无数据</td></tr>
    <tr><td>0x8201</td><td>打开传感器板串口失败</td></tr>
    <tr><td>0x8202</td><td>传感器板无数据</td></tr>
    <tr><td>0x2201</td><td>错误：导航未收到 tf 数据</td></tr>
    <tr><td>0x2202</td><td>错误：导航未收到地图数据</td></tr>
    <tr><td>0x2203</td><td>错误：导航未收到定位数据</td></tr>
    <tr><td>0x2204</td><td>错误：导航未收到超声波数据</td></tr>
    <tr><td>0x2205</td><td>错误：导航未收到激光数据</td></tr>
    <tr><td>0x2206</td><td>错误：导航未收到 RGBD 数据</td></tr>
    <tr><td>0x2207</td><td>错误：导航未收到多线激光数据</td></tr>
    <tr><td>0x2208</td><td>错误：导航未收到点 TOF 数据</td></tr>
    <tr><td>0x2209</td><td>错误：导航未收到面 TOF 数据</td></tr>
    <tr><td>0x220A</td><td>错误：导航未收到里程计数据</td></tr>
    <tr><td>0x2101</td><td>警告：导航未收到 tf 数据</td></tr>
    <tr><td>0x2102</td><td>警告：导航未收到地图数据</td></tr>
    <tr><td>0x2103</td><td>警告：导航未收到定位数据</td></tr>
    <tr><td>0x2104</td><td>警告：导航未收到超声波数据</td></tr>
    <tr><td>0x2105</td><td>警告：导航未收到激光数据</td></tr>
    <tr><td>0x2106</td><td>警告：导航未收到 RGBD TOF 数据</td></tr>
    <tr><td>0x2107</td><td>警告：导航未收到多线激光数据</td></tr>
    <tr><td>0x2108</td><td>警告：导航未收到点 TOF 数据</td></tr>
    <tr><td>0x2109</td><td>警告：导航未收到面 TOF 数据</td></tr>
    <tr><td>0x210A</td><td>警告：导航未收到里程计数据</td></tr>
    <tr><td>0x4201</td><td>SLAM 定位错误</td></tr>
    <tr><td>0x4102</td><td>错误：SLAM 未收到激光数据</td></tr>
    <tr><td>0x4103</td><td>错误：SLAM 未收到里程计数据</td></tr>
    <tr><td>0x4205</td><td>SLAM 地图错误</td></tr>
  </tbody>
</table>


## 枚举类型定义

### <code>BatteryState</code> — 电池状态枚举

<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>枚举值</strong></th>
      <th style="width: 20%; text-align: center;"><strong>数值</strong></th>
      <th style="width: 40%; text-align: center;"><strong>描述</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td><code>UNKNOWN</code></td><td>0</td><td>未知状态</td></tr>
    <tr><td><code>GOOD</code></td><td>1</td><td>良好</td></tr>
    <tr><td><code>OVERHEAT</code></td><td>2</td><td>过热</td></tr>
    <tr><td><code>DEAD</code></td><td>3</td><td>电量耗尽</td></tr>
    <tr><td><code>OVERVOLTAGE</code></td><td>4</td><td>过压</td></tr>
    <tr><td><code>UNSPEC_FAILURE</code></td><td>5</td><td>未指定故障</td></tr>
    <tr><td><code>COLD</code></td><td>6</td><td>过冷</td></tr>
    <tr><td><code>WATCHDOG_TIMER_EXPIRE</code></td><td>7</td><td>看门狗定时器超时</td></tr>
    <tr><td><code>SAFETY_TIMER_EXPIRE</code></td><td>8</td><td>安全定时器超时</td></tr>
  </tbody>
</table>

### <code>PowerSupplyStatus</code> — 电源状态枚举

<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>枚举值</strong></th>
      <th style="width: 20%; text-align: center;"><strong>数值</strong></th>
      <th style="width: 40%; text-align: center;"><strong>描述</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td><code>UNKNOWN</code></td><td>0</td><td>未知状态</td></tr>
    <tr><td><code>CHARGING</code></td><td>1</td><td>充电中</td></tr>
    <tr><td><code>DISCHARGING</code></td><td>2</td><td>放电中</td></tr>
    <tr><td><code>NOTCHARGING</code></td><td>3</td><td>未充电</td></tr>
    <tr><td><code>FULL</code></td><td>4</td><td>电量满</td></tr>
  </tbody>
</table>

## 数据结构定义

### <code>FaultVector</code> — 故障信息向量

<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>类型</td><td><code>std::vector&lt;magic::dog::Fault&gt;</code> 的 Python 绑定</td></tr>
    <tr><td>功能概述</td><td>存储故障信息的动态数组，用于系统状态监控和错误处理</td></tr>
    <tr><td>主要方法</td><td>支持标准 Python 列表操作，每个元素为 Fault 结构体</td></tr>
    <tr><td>使用场景</td><td>故障诊断、系统监控、错误日志记录</td></tr>
  </tbody>
</table>

### <code>Fault</code> — 故障信息结构体

<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>字段名</strong></th>
      <th style="width: 20%; text-align: center;"><strong>类型</strong></th>
      <th style="width: 40%; text-align: center;"><strong>描述</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td><code>error_code</code></td><td><code>int</code></td><td>错误代码</td></tr>
    <tr><td><code>error_message</code></td><td><code>str</code></td><td>错误消息</td></tr>
  </tbody>
</table>

### <code>BmsData</code> — 电池管理系统数据结构体

<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>字段名</strong></th>
      <th style="width: 20%; text-align: center;"><strong>类型</strong></th>
      <th style="width: 40%; text-align: center;"><strong>描述</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td><code>battery_percentage</code></td><td><code>float</code></td><td>电池电量百分比</td></tr>
    <tr><td><code>battery_health</code></td><td><code>float</code></td><td>电池健康度</td></tr>
    <tr><td><code>battery_state</code></td><td><code>BatteryState</code></td><td>电池状态</td></tr>
    <tr><td><code>power_supply_status</code></td><td><code>PowerSupplyStatus</code></td><td>电源状态</td></tr>
  </tbody>
</table>

### <code>RobotState</code> — 机器人状态结构体

<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>字段名</strong></th>
      <th style="width: 20%; text-align: center;"><strong>类型</strong></th>
      <th style="width: 40%; text-align: center;"><strong>描述</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td><code>faults</code></td><td><code>FaultVector</code></td><td>故障列表</td></tr>
    <tr><td><code>bms_data</code></td><td><code>BmsData</code></td><td>电池数据</td></tr>
  </tbody>
</table>