---
title: 机器人主控制服务
createTime: 2025/01/27 15:30:00
permalink: /dog/python_robot_reference/
---
# 机器人主控服务 (Python)

> 提供机器人系统主控制器，通过 MagicRobot 可以进行资源初始化、管理通信连接、访问各子控制器如运动控制器、音频控制器、状态监控以及传感器控制器等。

> ⚠️ **<font color="red">注意事项：使用 Python 接口时，请确保已正确构建 Python 绑定模块，并注意内存管理和线程安全。</font>**

## 模块信息

<code>magicdog_python</code> 是 MagicDog SDK 的 Python 绑定模块，提供了完整的机器人控制、传感器数据获取、音频处理等功能接口。

<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>模块名</td><td><code>magicdog_python</code></td></tr>
    <tr><td>描述</td><td>MagicDog SDK Python 绑定模块</td></tr>
    <tr><td>依赖</td><td>pybind11, C++ SDK</td></tr>
  </tbody>
</table>

## 接口定义

<code>MagicRobot</code> 是机器人系统的统一入口类。

### <code>MagicRobot</code> — 主机器人类

<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>类名</td><td><code>MagicRobot</code></td></tr>
    <tr><td>功能概述</td><td>机器人主控制类，整合所有功能模块</td></tr>
    <tr><td>主要功能</td><td>系统初始化、连接管理、控制器获取</td></tr>
    <tr><td>使用场景</td><td>机器人应用开发、系统集成、功能测试</td></tr>
  </tbody>
</table>

### initialize
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>initialize</code></td></tr>
    <tr><td>方法声明</td><td><code>bool initialize(const str& local_ip)</code></td></tr>
    <tr><td>功能概述</td><td>初始化机器人系统，包括控制器与网络模块。</td></tr>
    <tr><td>参数说明</td><td><code>local_ip</code>：本地通信 IP 地址。</td></tr>
    <tr><td>返回值</td><td><code>true</code> 表示成功，<code>false</code> 表示失败。</td></tr>
    <tr><td>备注</td><td>首次使用前必须调用。</td></tr>
  </tbody>
</table>

### shutdown
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>shutdown</code></td></tr>
    <tr><td>方法声明</td><td><code>void shutdown()</code></td></tr>
    <tr><td>功能概述</td><td>关闭机器人系统，释放资源。</td></tr>
    <tr><td>备注</td><td>配合 initialize 使用。</td></tr>
  </tbody>
</table>

### connect
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>connect</code></td></tr>
    <tr><td>方法声明</td><td><code>Status connect()</code></td></tr>
    <tr><td>功能概述</td><td>与机器人服务建立通信连接。</td></tr>
    <tr><td>参数说明</td><td><code>timeout_ms</code>：超时时间（毫秒），默认值为 5000。</td></tr>
    <tr><td>返回值</td><td><code>Status::OK</code> 表示成功。</td></tr>
    <tr><td>备注</td><td>阻塞接口，需初始化后调用。</td></tr>
  </tbody>
</table>

### disconnect
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>disconnect</code></td></tr>
    <tr><td>方法声明</td><td><code>Status disconnect()</code></td></tr>
    <tr><td>功能概述</td><td>断开与机器人服务的连接。</td></tr>
    <tr><td>参数说明</td><td><code>timeout_ms</code>：超时时间（毫秒），默认值为 5000。</td></tr>
    <tr><td>返回值</td><td><code>Status::OK</code> 表示成功。</td></tr>
    <tr><td>备注</td><td>阻塞接口，与 connect 配对使用。</td></tr>
  </tbody>
</table>

### get_sdk_version
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>get_sdk_version</code></td></tr>
    <tr><td>方法声明</td><td><code>str get_sdk_version()</code></td></tr>
    <tr><td>功能概述</td><td>获取当前 SDK 的版本号。</td></tr>
    <tr><td>返回值</td><td>SDK 版本字符串（如 <code>0.0.1</code>）。</td></tr>
    <tr><td>备注</td><td>非阻塞接口，便于调试或日志标记。</td></tr>
  </tbody>
</table>

### get_motion_control_level
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>get_motion_control_level</code></td></tr>
    <tr><td>方法声明</td><td><code>ControllerLevel get_motion_control_level()</code></td></tr>
    <tr><td>功能概述</td><td>获取当前运动控制级别（高层/低层）。</td></tr>
    <tr><td>返回值</td><td><code>ControllerLevel</code> 枚举值。</td></tr>
    <tr><td>备注</td><td>非阻塞接口，用于判断当前控制权限。</td></tr>
  </tbody>
</table>

### set_motion_control_level
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>set_motion_control_level</code></td></tr>
    <tr><td>方法声明</td><td><code>Status set_motion_control_level(ControllerLevel level)</code></td></tr>
    <tr><td>功能概述</td><td>设置当前运动控制级别。</td></tr>
    <tr><td>参数说明</td><td><code>level</code>：控制权限枚举值。</td></tr>
    <tr><td>返回值</td><td><code>Status::OK</code> 表示设置成功，其他代表设置失败。</td></tr>
    <tr><td>备注</td><td>阻塞接口，控制模式切换时使用。</td></tr>
  </tbody>
</table>

### get_high_level_motion_controller
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>get_high_level_motion_controller</code></td></tr>
    <tr><td>方法声明</td><td><code>HighLevelMotionController get_high_level_motion_controller()</code></td></tr>
    <tr><td>功能概述</td><td>获取高层运动控制器对象。</td></tr>
    <tr><td>返回值</td><td>高层运动控制器实例，用于调用高层控制接口。</td></tr>
    <tr><td>备注</td><td>非阻塞接口，封装了步态、特技、遥控等控制功能。</td></tr>
  </tbody>
</table>

### get_low_level_motion_controller
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>get_low_level_motion_controller</code></td></tr>
    <tr><td>方法声明</td><td><code>LowLevelMotionController get_low_level_motion_controller()</code></td></tr>
    <tr><td>功能概述</td><td>获取低层运动控制器对象。</td></tr>
    <tr><td>返回值</td><td>低层运动控制器实例，用于控制关节或电机。</td></tr>
    <tr><td>备注</td><td>非阻塞接口，可直接控制关节电机等。</td></tr>
  </tbody>
</table>

### get_audio_controller
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>get_audio_controller</code></td></tr>
    <tr><td>方法声明</td><td><code>AudioController get_audio_controller()</code></td></tr>
    <tr><td>功能概述</td><td>获取音频控制器对象。</td></tr>
    <tr><td>返回值</td><td>音频控制器实例，用于语音控制。</td></tr>
    <tr><td>备注</td><td>非阻塞接口，可播放语音和控制音量。</td></tr>
  </tbody>
</table>

### get_sensor_controller
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>get_sensor_controller</code></td></tr>
    <tr><td>方法声明</td><td><code>SensorController get_sensor_controller()</code></td></tr>
    <tr><td>功能概述</td><td>获取传感器控制器对象。</td></tr>
    <tr><td>返回值</td><td>传感器控制器实例，用于访问传感器数据。</td></tr>
    <tr><td>备注</td><td>非阻塞接口，封装了 IMU、RGBD 等传感器数据读取。</td></tr>
  </tbody>
</table>

### get_state_monitor
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>get_state_monitor</code></td></tr>
    <tr><td>方法声明</td><td><code>StateMonitor get_state_monitor()</code></td></tr>
    <tr><td>功能概述</td><td>获取状态监控器对象。</td></tr>
    <tr><td>返回值</td><td>状态监控器实例，用于获取机器人当前状态信息。</td></tr>
    <tr><td>备注</td><td>非阻塞接口，封装了 BMS、故障等状态信息的读取。</td></tr>
  </tbody>
</table>

## 常量定义

<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>常量名</strong></th>
      <th style="width: 20%; text-align: center;"><strong>类型</strong></th>
      <th style="width: 40%; text-align: center;"><strong>描述</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td><code>LEG_JOINT_NUM</code></td><td><code>int</code></td><td>腿部关节数量</td></tr>
    <tr><td><code>PERIOD_MS</code></td><td><code>int</code></td><td>控制周期（毫秒）</td></tr>
  </tbody>
</table>

## 数据结构定义

### <code>Status</code> — 状态返回结构体

<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>字段名</strong></th>
      <th style="width: 20%; text-align: center;"><strong>类型</strong></th>
      <th style="width: 40%; text-align: center;"><strong>描述</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td><code>code</code></td><td><code>ErrorCode</code></td><td>错误代码</td></tr>
    <tr><td><code>message</code></td><td><code>str</code></td><td>状态消息</td></tr>
  </tbody>
</table>

### <code>ErrorCode</code> — 错误代码枚举

<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>枚举值</strong></th>
      <th style="width: 20%; text-align: center;"><strong>数值</strong></th>
      <th style="width: 40%; text-align: center;"><strong>描述</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td><code>OK</code></td><td>0</td><td>操作成功</td></tr>
    <tr><td><code>SERVICE_NOT_READY</code></td><td>1</td><td>服务未就绪</td></tr>
    <tr><td><code>TIMEOUT</code></td><td>2</td><td>操作超时</td></tr>
    <tr><td><code>INTERNAL_ERROR</code></td><td>3</td><td>内部错误</td></tr>
    <tr><td><code>SERVICE_ERROR</code></td><td>4</td><td>服务错误</td></tr>
  </tbody>
</table>